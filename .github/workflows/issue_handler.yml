name: Issue Handler
on:
  issues:
    types: [opened, edited]

jobs:
  run-local-script:
    runs-on: [self-hosted, macOS, ARM64, gsd]
    steps:
      - name: Run my script
        env:
          ISSUE_NUMBER: ${{ github.event.issue.number }}
          ISSUE_TITLE: ${{ github.event.issue.title }}
          ISSUE_BODY: ${{ github.event.issue.body }}
          ISSUE_STATE: ${{ github.event.issue.state }}
          ISSUE_AUTHOR: ${{ github.event.issue.user.login }}
          ISSUE_URL: ${{ github.event.issue.html_url }}
          ISSUE_LABELS: ${{ toJSON(github.event.issue.labels) }}
          ACTION_TYPE: ${{ github.event.action }}
          REPO_NAME: ${{ github.repository }}
        run: |
          echo "Issue number: $ISSUE_NUMBER"
          echo "Issue title: $ISSUE_TITLE"
          echo "Action triggered: $ACTION_TYPE"
          echo "Author: $ISSUE_AUTHOR"
          echo "Labels: $ISSUE_LABELS"
          python /Users/lcm/Projects/curator-agent-sde/test.py \
            --issue-number "$ISSUE_NUMBER" \
            --action "$ACTION_TYPE" \
            --title "$ISSUE_TITLE" \
            --author "$ISSUE_AUTHOR" \
            --state "$ISSUE_STATE" \
            --url "$ISSUE_URL" \
            --repo "$REPO_NAME" \
            --body "$ISSUE_BODY" \
            --labels "$ISSUE_LABELS" 
